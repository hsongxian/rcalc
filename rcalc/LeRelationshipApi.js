
		var res = "父亲/ 父亲:爷爷,母亲:外公,哥哥:父亲,弟弟:父亲,姐姐:父亲,妹妹:父亲,儿子:我(Iam=M),儿子:丈夫(Iam=F),女儿:我(Iam=M),女儿:丈夫(Iam=F),丈夫:公公(Iam=F),妻子:岳父(Iam=M),爷爷:太爷爷,外公:外太爷爷,奶奶:外太爷爷,外婆:外太爷爷,伯父:爷爷,叔父:爷爷,姑妈:爷爷,小姑子:爷爷,舅父:外公,姨妈:外公,姨:外公,大姑子:老爷(Iam=F),小姑子:老爷(Iam=F),大伯:老爷(Iam=F),小叔:老爷(Iam=F),大舅子:岳父(Iam=M),小舅子:岳父(Iam=M),大姨子:岳父(Iam=M),小姨子:岳父(Iam=M),太爷爷:高祖父,高祖父:天祖父,天祖父:烈祖父,烈祖父:太祖父,太祖父:远祖父,远祖父:鼻祖父,侄子:我?哥哥|弟弟,侄女:我?哥哥|弟弟,侄子:我?哥哥|弟弟,侄女:我?哥哥|弟弟,岳母:太岳父,岳父:太岳父,女婿:亲家公,儿媳:亲家公,老爷:太老爷,嫂:姻世伯,嫂:姻世伯,弟媳:姻世伯,弟媳:姻世伯,姐夫:姻世伯,姐夫:姻世伯,妹夫:姻世伯,妹夫:姻世伯,堂兄:父亲?伯父|叔父,堂弟:父亲?伯父|叔父,堂姐:父亲?伯父|叔父,堂妹:父亲?伯父|叔父,表兄:舅父或姨丈或姑丈,表弟:舅父或姨丈或姑丈,表姐:舅父或姨丈或姑丈,表妹:舅父或姨丈或姑丈,伯公:太爷爷,叔公:太爷爷,姑婆:太爷爷,姨婆:外太爷爷,舅公:外太爷爷,外伯公:外太爷爷,外叔公:外太爷爷,外姑婆:外太爷爷,外姨婆:外太爷爷,外舅公:外太爷爷,表伯:舅公,表叔:舅公 ; " +
			"母亲/ 父亲:奶奶,母亲:外婆,哥哥:母亲,弟弟:母亲,姐姐:母亲,妹妹:母亲,儿子:我(Iam=F),儿子:妻子(Iam=M),女儿:我(Iam=F),女儿:妻子(Iam=M),丈夫:婆婆(Iam=F),妻子:岳母(Iam=M),爷爷:太婆,外公:外太婆,奶奶:外太婆,外婆:外太婆,伯父:奶奶,叔父:奶奶,姑妈:奶奶,小姑子:奶奶,舅父:外婆,姨妈:外婆,姨:外婆,大姑子:奶奶(Iam=F),小姑子:奶奶(Iam=F),大伯:奶奶(Iam=F),小叔:奶奶(Iam=F),大舅子:岳母(Iam=M),小舅子:岳母(Iam=M),大姨子:岳母(Iam=M),小姨子:岳母(Iam=M),侄子:嫂或弟媳,侄女:嫂或弟媳,侄子:嫂或弟媳,侄女:嫂或弟媳,岳母:太岳母,岳父:太岳母,女婿:亲家母,儿媳:亲家母,老爷:太奶奶,嫂:姻伯母,嫂:姻伯母,弟媳:姻伯母,弟媳:姻伯母,姐夫:姻伯母,姐夫:姻伯母,妹夫:姻伯母,妹夫:姻伯母,堂兄:伯母或婶,堂弟:伯母或婶,堂姐:伯母或婶,堂妹:伯母或婶,表兄:小姑子或姑妈或姨妈或姨或舅母,表弟:小姑子或姑妈或姨妈或姨或舅母,表姐:小姑子或姑妈或姨妈或姨或舅母,表妹:小姑子或姑妈或姨妈或姨或舅母,伯公:太婆,叔公:太婆,姑婆:太婆,姨婆:外太婆,舅公:外太婆,外伯公:外太婆,外叔公:外太婆,外姑婆:外太婆,外姨婆:外太婆,外舅公:外太婆,表伯:舅婆,表叔:舅婆 ; " +
			"哥哥/ 父亲:伯父,母亲:舅父,哥哥:哥哥,弟弟:我?哥哥|弟弟,姐姐:哥哥,妹妹:我?哥哥|弟弟,儿子:儿子,女儿:儿子,丈夫:大伯(Iam=F),妻子:大舅子(Iam=M),爷爷:伯公,外公:外伯公,奶奶:舅公,外婆:外舅公,伯父:伯父,叔父:父亲?伯父|叔父,姑妈:伯父,小姑子:父亲?伯父|叔父,舅父:舅父,姨妈:舅父,姨:舅父,大姑子:大伯(Iam=F),小姑子:丈夫?大伯|小叔,大伯:大伯(Iam=F),小叔:丈夫?大伯|小叔,大舅子:大舅子(Iam=M),小舅子:妻子?大舅子|小舅子,大姨子:大舅子(Iam=M),小姨子:妻子?大舅子|小舅子,太爷爷:太伯公,太婆:太舅公,侄子:侄子,侄女:侄子,侄子:侄子,侄女:侄子,岳母:舅岳父,岳父:伯岳父,老爷:伯老爷,堂兄:堂兄,堂弟:我?堂兄|堂弟,堂姐:堂兄,堂妹:我?堂兄|堂弟,表兄:表兄,表弟:我?表兄|表弟,表姐:表兄,表妹:我?表兄|表弟,伯公:伯公,叔公:爷爷?伯公|叔公,姑婆:爷爷?伯公|叔公,姨婆:舅公,舅公:舅公,外伯公:外伯公,外叔公:外公?外伯公|外叔公,外姑婆:外公?外伯公|外叔公,外姨婆:外舅公,外舅公:外舅公,太老爷:伯公老爷,太奶奶:舅公老爷,太舅公:太舅公,表伯:表伯,表叔:父亲?表伯|表叔 ; " +
			"弟弟/ 父亲:叔父,母亲:舅父,哥哥:我?哥哥|弟弟,弟弟:弟弟,姐姐:我?哥哥|弟弟,妹妹:弟弟,儿子:儿子,女儿:儿子,丈夫:小叔(Iam=F),妻子:小舅子(Iam=M),爷爷:叔公,外公:外叔公,奶奶:舅公,外婆:外舅公,伯父:父亲?伯父|叔父,叔父:叔父,姑妈:父亲?伯父|叔父,小姑子:叔父,舅父:舅父,姨妈:舅父,姨:舅父,大姑子:丈夫?大伯|小叔,小姑子:小叔(Iam=F),大伯:丈夫?大伯|小叔,小叔:小叔(Iam=F),大舅子:妻子?大舅子|小舅子,小舅子:小舅子(Iam=M),大姨子:妻子?大舅子|小舅子,小姨子:小舅子(Iam=M),太爷爷:太叔公,太婆:太舅公,侄子:侄子,侄女:侄子,侄子:侄子,侄女:侄子,岳母:舅岳父,岳父:叔岳父,老爷:叔老爷,堂兄:我?堂兄|堂弟,堂弟:堂弟,堂姐:我?堂兄|堂弟,堂妹:堂弟,表兄:我?表兄|表弟,表弟:表弟,表姐:我?表兄|表弟,表妹:表弟,伯公:爷爷?伯公|叔公,叔公:叔公,姑婆:爷爷?伯公|叔公,姨婆:舅公,舅公:舅公,外伯公:外公?外伯公|外叔公,外叔公:外叔公,外姑婆:外公?外伯公|外叔公,外姨婆:外舅公,外舅公:外舅公,太老爷:叔公老爷,太奶奶:舅公老爷,太舅公:太舅公,表伯:父亲?表伯|表叔,表叔:表叔 ; " +
			"姐姐/ 父亲:姑妈,母亲:姨妈,哥哥:姐姐,弟弟:我?姐姐|妹妹,姐姐:姐姐,妹妹:我?姐姐|妹妹,儿子:女儿,女儿:女儿,丈夫:大姑子(Iam=F),妻子:大姨子(Iam=M),爷爷:姑婆,外公:外姑婆,奶奶:姨婆,外婆:外姨婆,伯父:姑妈,叔父:父亲?姑妈|小姑子,姑妈:姑妈,小姑子:父亲?姑妈|小姑子,舅父:母亲?姨妈|姨,姨妈:姨妈,姨:母亲?姨妈|姨,大姑子:大姑子(Iam=F),小姑子:丈夫?大姑子|小姑子,大伯:大姑子(Iam=F),小叔:丈夫?大姑子|小姑子,大舅子:大姨子(Iam=M),小舅子:妻子?大姨子|小姨子,大姨子:大姨子(Iam=M),小姨子:妻子?大姨子|小姨子,太爷爷:太姑妈,太婆:太姨婆,侄子:侄女,侄女:侄女,侄子:侄女,侄女:侄女,岳母:姨岳母,岳父:姑岳母,老爷:姑奶奶,堂兄:堂姐,堂弟:我?堂姐|堂妹,堂姐:堂姐,堂妹:我?堂姐|堂妹,表兄:表姐,表弟:我?表姐|表妹,表姐:表姐,表妹:我?表姐|表妹,伯公:姑婆,叔公:姑婆,姑婆:姑婆,姨婆:姨婆,舅公:姨婆,外伯公:外姑婆,外叔公:外姑婆,外姑婆:外姑婆,外姨婆:外姨婆,外舅公:外姨婆,太老爷:姑婆奶奶,太奶奶:姨婆奶奶,太舅公:太姨婆,表伯:表姑妈,表叔:父亲?表姑妈|表小姑子 ; " +
			"妹妹/ 父亲:小姑子,母亲:姨,哥哥:我?姐姐|妹妹,弟弟:妹妹,姐姐:我?姐姐|妹妹,妹妹:妹妹,儿子:女儿,女儿:女儿,丈夫:小姑子(Iam=F),妻子:小姨子(Iam=M),爷爷:姑婆,外公:外姑婆,奶奶:姨婆,外婆:外姨婆,伯父:父亲?姑妈|小姑子,叔父:小姑子,姑妈:父亲?姑妈|小姑子,小姑子:小姑子,舅父:母亲?姨妈|姨,姨妈:母亲?姨妈|姨,姨:姨,大姑子:丈夫?大姑子|小姑子,小姑子:小姑子(Iam=F),大伯:丈夫?大姑子|小姑子,小叔:小姑子(Iam=F),大舅子:妻子?大姨子|小姨子,小舅子:小姨子(Iam=M),大姨子:妻子?大姨子|小姨子,小姨子:小姨子(Iam=M),太爷爷:太姑妈,太婆:太姨婆,侄子:侄女,侄女:侄女,侄子:侄女,侄女:侄女,岳母:姨岳母,岳父:姑岳母,老爷:姑奶奶,堂兄:我?堂姐|堂妹,堂弟:堂妹,堂姐:我?堂姐|堂妹,堂妹:堂妹,表兄:我?表姐|表妹,表弟:表妹,表姐:我?表姐|表妹,表妹:表妹,伯公:姑婆,叔公:姑婆,姑婆:姑婆,姨婆:姨婆,舅公:姨婆,外伯公:外姑婆,外叔公:外姑婆,外姑婆:外姑婆,外姨婆:外姨婆,外舅公:外姨婆,太老爷:姑婆奶奶,太奶奶:姨婆奶奶,太舅公:太姨婆,表伯:父亲?表姑妈|表小姑子,表叔:表小姑子 ; " +
			"儿子/ 父亲:我?哥哥|弟弟,母亲:我?哥哥|弟弟,哥哥:侄子,弟弟:侄子,姐姐:外甥,妹妹:外甥,儿子:孙子,女儿:外孙,丈夫:儿子(Iam=F),妻子:儿子(Iam=M),爷爷:父亲?伯父|叔父,外公:舅父,奶奶:父亲?伯父|叔父,外婆:舅父,伯父:我?堂兄|堂弟,叔父:我?堂兄|堂弟,姑妈:我?表兄|表弟,小姑子:我?表兄|表弟,舅父:我?表兄|表弟,姨妈:我?表兄|表弟,姨:我?表兄|表弟,孙子:曾孙,曾孙:玄孙,玄孙:来孙,来孙:晜孙,晜孙:仍孙,仍孙:云孙,云孙:耳孙,孙女:外曾孙,外孙:外曾孙,外孙女:外曾孙,外太爷爷:舅父或叔父或伯父,外太婆:舅父或叔父或伯父,岳母:妻子?大舅子|小舅子,岳父:妻子?大舅子|小舅子,女婿:外孙,奶奶:丈夫?大伯|小叔,儿媳:孙子,老爷:丈夫?大伯|小叔,嫂:侄子,弟媳:侄子,姐夫:外甥,妹夫:外甥,姑丈:我?表兄|表弟,婶:我?堂兄|堂弟,伯母:我?堂兄|堂弟,姨丈:我?表兄|表弟,舅母:我?表兄|表弟,堂兄:堂侄子,堂弟:堂侄子,堂姐:堂外甥,堂妹:堂外甥,表兄:表侄子,表弟:表侄子,表姐:表外甥,表妹:表外甥,伯公:父亲?堂伯|堂叔,叔公:父亲?堂伯|堂叔,姑婆:父亲?表伯|表叔,姨婆:父亲?表伯|表叔,舅公:父亲?表伯|表叔,外伯公:表舅父,外叔公:表舅父,外姑婆:表舅父,外姨婆:表舅父,外舅公:表舅父,太老爷:老爷?伯老爷|叔老爷,太奶奶:老爷?伯老爷|叔老爷,舅公老爷:丈夫?表大伯|表小叔,太舅公:爷爷?表伯公|表叔公,表伯:我?表哥|表弟,表叔:我?表哥|表弟 ; " +
			"女儿/ 父亲:我?姐姐|妹妹,母亲:我?姐姐|妹妹,哥哥:侄女,弟弟:侄女,姐姐:外甥女,妹妹:外甥女,儿子:孙女,女儿:外孙女,丈夫:女儿,妻子:女儿,爷爷:父亲?姑妈|小姑子,外公:母亲?姨妈|姨,奶奶:父亲?姑妈|小姑子,外婆:母亲?姨妈|姨,伯父:我?堂姐|堂妹,叔父:我?堂姐|堂妹,姑妈:我?表姐|表妹,小姑子:我?表姐|表妹,舅父:我?表姐|表妹,姨妈:我?表姐|表妹,姨:我?表姐|表妹,孙子:曾孙女,孙女:外曾孙女,外孙:外曾孙女,外孙女:外曾孙女,外太爷爷:小姑子或姑妈或姨妈或姨,外太婆:小姑子或姑妈或或姨妈或姨,岳母:妻子?大姨子|小姨子,岳父:妻子?大姨子|小姨子,女婿:外孙女,奶奶:丈夫?大姑子|小姑子,儿媳:孙女,老爷:丈夫?大姑子|小姑子,嫂:侄女,弟媳:侄女,姐夫:外甥女,妹夫:外甥女,姑丈:我?表姐|表妹,婶:我?堂姐|堂妹,伯母:我?堂姐|堂妹,姨丈:我?表姐|表妹,舅母:我?表姐|表妹,堂兄:堂侄女,堂弟:堂侄女,堂姐:堂外甥女,堂妹:堂外甥女,堂兄:堂侄女,表兄:表侄女,表弟:表侄女,表姐:表外甥女,表妹:表外甥女,伯公:父亲?堂姑妈|堂小姑子,叔公:父亲?堂姑妈|堂小姑子,姑婆:父亲?表姑妈|表小姑子,姨婆:父亲?表姑妈|表小姑子,舅公:父亲?表姑妈|表小姑子,外伯公:母亲?表姨妈|表姨,外叔公:母亲?表姨妈|表姨,外姑婆:母亲?表姨妈|表姨,外姨婆:母亲?表姨妈|表姨,外舅公:母亲?表姨妈|表姨,太老爷:姑奶奶,太奶奶:姑奶奶,舅公老爷:丈夫?表姑妈|表小姑子,太舅公:表姑婆,表伯:我?表姐|表妹,表叔:我?表姐|表妹 ; " +
			"丈夫/ 母亲:父亲,姐姐:姐夫,妹妹:妹夫,女儿:女婿,妻子:我(Iam=M),奶奶:爷爷,外婆:外公,姑妈:姑丈,小姑子:姑夫,姨妈:姨丈,姨:姨丈,大姑子:姑爷(Iam=F),小姑子:姑爷(Iam=F),大姨子:襟兄(Iam=M),小姨子:襟弟(Iam=M),孙女:孙女婿,外孙女:外孙女婿,侄女:侄女婿,侄女:侄女婿,外太婆:外太爷爷,岳母:岳父,奶奶:老爷,儿媳:儿子,嫂:哥哥,弟媳:弟弟,婶:叔父,伯母:伯父,舅母:舅父,堂姐:堂姐夫,堂妹:堂妹夫,表姐:表姐夫,表妹:表妹夫,姑婆:姑丈公,姨婆:姨公,外姑婆:外姑丈公,外姨婆:外姨公,太奶奶:太老爷,姑婆奶奶:姑公老爷,姨婆奶奶:姨公老爷 ; " +
			"妻子/ 父亲:母亲,哥哥:嫂,弟弟:弟媳,儿子:儿媳,丈夫:我(Iam=F),爷爷:奶奶,外公:外婆,伯父:伯母,叔父:婶,舅父:舅母,大伯:大嫂(Iam=F),小叔:小婶(Iam=F),大舅子:舅嫂(Iam=M),小舅子:舅弟媳(Iam=M),孙子:孙儿媳,外孙:外孙儿媳,侄子:侄儿媳,侄子:姪儿媳,外太爷爷:外太婆,岳父:岳母,女婿:女儿,老爷:奶奶,姐夫:姐姐,妹夫:妹妹,姑丈:父亲?姑妈|小姑子,姨丈:母亲?姨妈|姨,堂兄:堂嫂,堂弟:堂弟媳,表兄:表嫂,表弟:表弟媳,伯公:伯婆,叔公:叔婆,舅公:舅婆,外伯公:外伯婆,外叔公:外叔婆,外舅公:外舅婆,太老爷:太奶奶,伯公老爷:伯婆奶奶,叔公老爷:叔婆奶奶,舅公老爷:舅婆奶奶,太舅公:太舅婆,表伯:表伯母,表叔:表婶 ;";
		var strs = res.split(" ; ");
		var sex = "M";
		function iAmFeMale() {
			sex = "F";
		}
		function iAmMale() {
			sex = "M";
		}
		
		var allRelations = new Array();
		for (var i = 0; i < strs.length; i++) {
			if (strs[i] == "") {
				continue;
			}
			var des = getRelationName(strs[i]);
			// document.write("title = " + des[0] + "<br/>");
			var localrelation = des[1];
			var r = new personrelation(des[0]);
			var rs = getRelations(localrelation);
			for (var j = 0; j < rs.length; j ++) {
				// document.write("关系 = " + rs[j] + "<br/>");
				group = rs[j].split(":");
				// document.write("关系 = " + group[1] + "<br/>");
				r.put(group[0], group[1]);
			}
			allRelations.push(r);
		}


		function getRelationName(des) {
			var names = des.split("/ ");
			return names;
		};

		function getRelations(des)  {
			var result = des.split(",");
			return result;
		}


		function personrelation(_relationName) {
			this.relationName = _relationName;
			this.elements = new Array();
			this.put = function(_key, _value) {     
		        this.elements.push({     
        	    	key : _key,     
            		value : _value     
        		});     
			};
		}

		var myOperations = new Array();
		var tempResult = "";
		var findnothing = false;
		var exceptinflag = "╮(￣▽￣\")╭";
		function addRelation (_relationName) {
			var oplength = myOperations.length;
			if (oplength > 0) {
				// console.log("result = " + myOperations[oplength - 1].result + " " + myOperations[oplength - 1].inputname + " " + _relationName);			
				var lastResult = myOperations[oplength - 1].result;
				var newResult = findRelation(lastResult, _relationName);
				if (newResult == "") {
					findnothing = true;
					newResult = exceptinflag;
				}
				if (isNeedCheckAge(newResult)) {
					tempResult = {
						inputname : _relationName,
						result: newResult
					}
					return;
				}
				// newResult = checkResult(newResult);
				newResult = checkSex(newResult);
				myOperations.push({
					inputname : _relationName,
					result: newResult
				});
			} else {
					var tmp_result = _relationName;
					if ("丈夫" == _relationName && sex == "M") {
						findnothing = true;
						tmp_result = exceptinflag;
					} else if ("妻子" == _relationName && sex  == "F") {
						findnothing = true;
						tmp_result = exceptinflag;
					} 
					myOperations.push({
						inputname : _relationName,
						result: tmp_result
					});
			}
			oplength = myOperations.length;
			// return myOperations[oplength - 1].result;
		}

		function getNewestResult() {
			var oplength = myOperations.length;
			if (oplength > 0){
				return myOperations[oplength - 1].result;
			} else {
				return "-,-";
			}
		}

		//是否需要检查年龄.
		function shouldCheckAge() {
			if (tempResult != "") {
				return true;
			}
			return false;
		}

		//获取需要比较的人物关系.
		function getAgeCmpPersion() {
			var str = tempResult.result;
			var i = str.indexOf("?");
			if (i < 0) {
				return str;
			}
			var r = str.split(/[?|]/);
			return r[0];
		}

		//通知当前人物是否大于这个人..
		function notifyIsOlder(_isOlder) {
			var str = tempResult.result;
			var i = str.indexOf("?");
			if (i < 0) {
				return;
			}
			var r = str.split(/[?|]/);
			if (_isOlder) {
				str = r[1];
			} else {
				str = r[2];
			}
			tempResult.result = checkSex(str);
			myOperations.push(tempResult);
			tempResult = "";
		}

		function resetOperation() {
			var oplength = myOperations.length;
			if (oplength > 0) {
				var _inputname = myOperations[oplength - 1].result;
				var _result = myOperations[oplength - 1].result;
				myOperations = new Array();
				myOperations.push({
					inputname : _inputname,
					result : _result
				})
			}
		}

		function checkException() {
			if (findnothing) {
				findnothing = false;
				clearRelation();
			}
		}

		//内部用，外部不要调用。by 新手.
		function isNeedCheckAge(str) {
			var i = str.indexOf("?");
			if (i < 0) {
				return false;
			}
			return true;
		}

		//我?哥哥|弟弟
		function checkResult(str) {
			var i = str.indexOf("?");
			if (i < 0) {
				return str;
			}
			var r = str.split(/[?|]/);
			if (isOlderThanMe(r[0])) {
				return r[1];
			} else {
				return r[2];
			}
		}

		function checkSex(str) {
			var index = str.indexOf("(Iam=");
			if (index >= 0) {
				return str.substring(0, index);
			}
			return str;
		}

		function isOlderThanMe(_persion) {
			return false;
		}

		function removeRelation () {
			myOperations.pop();
		}

		function getTopPersion() {
			if (myOperations.length == 0) {
				return "我";
			}
			return myOperations[myOperations.length - 1].inputname;
		}

		function genProcessText(suffix) {
			if (myOperations.length == 0) {
				return "我" + suffix;
			}
			var process = "";
			for (var i = 0; i < myOperations.length - 1; i++) {
				process += myOperations[i].inputname + "的 "
			}
			process += myOperations[i].inputname + suffix;
			return process;
		}

		function clearRelation() {
			myOperations = new Array();
			findnothing = false;
		}

		function findRelation(_firstRelation, _secondRelation) {
			var p = "";
			var resultStr = "";
			if (_firstRelation.indexOf("我") >= 0) {
				return _secondRelation;
			}
			// console.log("什么鬼 " + _firstRelation + " " + _secondRelation);
			for (var i = 0; i < allRelations.length; i++) {
				// console.log("i am looking for " + "x" + allRelations[i].relationName + "x  s = x" + _secondRelation + "x");
				if (_secondRelation == allRelations[i].relationName) {
					p = allRelations[i];
					for (var j = 0; j < p.elements.length; j++) {
						if (_firstRelation == p.elements[j].key) {
							resultStr = p.elements[j].value;
							if (resultStr.indexOf("Iam=") >= 0) {
								if (resultStr.indexOf(sex) >= 0) {
									break;
								} else {
									resultStr = "";
								}
							} else {
								break;
							}
						}
					}
					break;
				}
			}
			return resultStr;
		}